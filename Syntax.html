

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Syntax &mdash; Stroscot  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Overloading" href="Overloading.html" />
    <link rel="prev" title="Optimal reduction" href="Optimal-Reduction.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Stroscot
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Arguments.html">Argument passing</a></li>
<li class="toctree-l1"><a class="reference internal" href="Delimited-Continuations.html">Delimited continuations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Optimal-Reduction.html">Optimal reduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Syntax</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#arithmetic-and-parentheses">Arithmetic and Parentheses</a></li>
<li class="toctree-l2"><a class="reference internal" href="#strings">Strings</a></li>
<li class="toctree-l2"><a class="reference internal" href="#structured-data">Structured Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#parsing">Parsing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Overloading.html">Overloading</a></li>
<li class="toctree-l1"><a class="reference internal" href="Types.html">Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="Memory.html">Memory management</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Stroscot</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Syntax</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/Mathnerd314/stroscot/edit/master/docs/Syntax.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="syntax">
<h1>Syntax<a class="headerlink" href="#syntax" title="Permalink to this headline">¶</a></h1>
<p>The basics are numbers, booleans, and character strings of text.
But there’s always more.</p>
<div class="section" id="arithmetic-and-parentheses">
<h2>Arithmetic and Parentheses<a class="headerlink" href="#arithmetic-and-parentheses" title="Permalink to this headline">¶</a></h2>
<p>Stroscot supports your typical arithmetic operations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pi_approx</span> <span class="o">=</span> <span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">7</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="p">))</span>
<span class="c1"># 355/113 = 3.14159292035...</span>
</pre></div>
</div>
<p>For brevity, leading and trailing parentheses can be omitted:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pi_approx</span> <span class="o">=</span> <span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">7</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">15</span><span class="o">+</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span>
<span class="c1"># 355/113</span>
</pre></div>
</div>
<p>If you don’t like this, you can set Stroscot to warn or error on
unmatched parentheses.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stroscot</span> <span class="o">-</span><span class="n">Wunmatched_parentheses</span> <span class="n">pi_approx</span>
<span class="c1"># Warning: unmatched parentheses</span>
<span class="c1"># 355/113</span>
<span class="n">stroscot</span> <span class="o">-</span><span class="n">Eunmatched_parentheses</span> <span class="n">pi_approx</span>
<span class="c1"># Error: unmatched parentheses</span>
<span class="c1"># Aborted.</span>
</pre></div>
</div>
<p>A gentler approach is to reformat the code to add parentheses:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">stroscot</span> <span class="o">-</span><span class="n">Funmatched_parentheses</span> <span class="n">pi_approx</span>
<span class="c1"># Log: fixing unmatched parentheses</span>
</pre></div>
</div>
<p>This option is on by default and running a source code formatter is
always good practice.</p>
</div>
<div class="section" id="strings">
<h2>Strings<a class="headerlink" href="#strings" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&quot;Hello world!&quot;
``Hello user ${id}``
[Enclosed text]
&#39;short&#39;
</pre></div>
</div>
<p>Concatenation is <code class="docutils literal notranslate"><span class="pre">+</span></code>. Most operators are textual:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">true</span> <span class="ow">and</span> <span class="n">false</span> <span class="o">=</span> <span class="n">false</span>
<span class="n">true</span> <span class="ow">or</span> <span class="n">false</span> <span class="o">=</span> <span class="n">true</span>
<span class="n">true</span> <span class="n">xor</span> <span class="n">true</span> <span class="o">=</span> <span class="n">false</span>
<span class="mi">5</span> <span class="n">mod</span> <span class="mi">2</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">raise</span> <span class="n">x</span> <span class="n">by</span> <span class="mi">1</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">true</span> <span class="n">then</span> <span class="mi">1</span> <span class="k">else</span> <span class="mi">2</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">repeat</span> <span class="k">while</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="p">{</span> <span class="n">x</span> <span class="o">-=</span> <span class="mi">1</span> <span class="p">}</span>
<span class="n">repeat</span> <span class="n">until</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">{</span> <span class="n">x</span> <span class="o">-=</span> <span class="mi">1</span> <span class="p">}</span>
<span class="n">repeat</span> <span class="mi">10</span> <span class="n">times</span> <span class="p">{</span> <span class="n">x</span> <span class="o">-=</span> <span class="mi">1</span> <span class="p">}</span>
<span class="n">repeat</span> <span class="p">{</span> <span class="n">x</span> <span class="o">-=</span> <span class="mi">1</span> <span class="p">}</span> <span class="k">while</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">procedure</span> <span class="n">foo</span>
  <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="n">provide</span> <span class="n">x</span>

<span class="n">obtain</span> <span class="n">http_server</span>
<span class="n">procedure</span> <span class="n">main</span>
  <span class="n">parse_args</span>
  <span class="n">build_folder</span>
  <span class="n">http_server</span><span class="o">.</span><span class="n">serve</span><span class="p">(</span><span class="n">folder</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">check</span> <span class="p">{</span>
  <span class="n">risky_procedure</span>
<span class="p">}</span> <span class="n">error</span> <span class="p">{</span>
  <span class="n">fix</span><span class="p">(</span><span class="n">error</span><span class="p">)</span> <span class="ow">or</span> <span class="n">error</span><span class="p">(</span><span class="s2">&quot;wtf&quot;</span><span class="p">)</span>
<span class="p">}</span> <span class="n">regardless</span> <span class="p">{</span>
  <span class="n">save_logs</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="nb">input</span> <span class="n">number</span>
<span class="n">display</span> <span class="n">x</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">comment</span>
<span class="o">/*</span> <span class="n">multiline</span>
<span class="n">comment</span> <span class="o">*/</span>
</pre></div>
</div>
</div>
<div class="section" id="structured-data">
<h2>Structured Data<a class="headerlink" href="#structured-data" title="Permalink to this headline">¶</a></h2>
<p>Stroscot supports records, arrays, and arbitrary atoms as well. A record of functions is called a vtable. Structural subtyping of records is supported: you can pass <code class="docutils literal notranslate"><span class="pre">{a:</span> <span class="pre">1,</span> <span class="pre">b:</span> <span class="pre">2}</span></code> to a function expecting only <code class="docutils literal notranslate"><span class="pre">{b:</span> <span class="pre">Int}</span></code>.</p>
</div>
<div class="section" id="parsing">
<h2>Parsing<a class="headerlink" href="#parsing" title="Permalink to this headline">¶</a></h2>
<p>I’ve got a basic Earley algorithm working for now. But eventually I’m extending it with BSRs and layout and <a class="reference external" href="http://www.cse.chalmers.se/~nad/publications/danielsson-norell-mixfix.pdf">mix</a><a class="reference external" href="http://www.bramvandersanden.com/publication/pdf/sanden2014thesis.pdf">fix</a> and other fun things. There’s also <a class="reference external" href="https://github.com/attresearch/yakker">Yakker</a>, which is the most developed parser I’ve seen feature-wise. It’s only missing incremental parsing.</p>
<blockquote>
<div><p>A new parsing engine, Yakker, capable of handling the requirements of modern applications including full scannerless context-free grammars with regular expressions as right-hand sides for defining nonterminals. Yakker also includes facilities for binding variables to intermediate parse results and using such bindings within arbitrary constraints to control parsing. Yakker supports both semantic actions and speculative parsing techniques such as backtracking and context-free lookahead and several parsing back ends (including Earley, GLR and backtracking).  In addition, nonterminals may be parameterized by arbitrary values, which gives the system good modularity and abstraction properties in the presence of data-dependent parsing. Finally, legacy parsing libraries, such as sophisticated libraries for dates and times, may be directly incorporated into parser specifications.</p>
</div></blockquote>
<p>Operator precedence will be a DAG, rather than levels.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">precedence</span> <span class="n">_</span><span class="o">*</span><span class="n">_</span> <span class="n">higher</span> <span class="n">than</span> <span class="n">_</span><span class="o">+</span><span class="n">_</span>
<span class="n">precedence</span> <span class="n">_</span><span class="o">/</span><span class="n">_</span> <span class="n">equals</span> <span class="n">_</span><span class="o">*</span><span class="n">_</span>
</pre></div>
</div>
<p>I’ve looked at various algorithms but I think the only way to handle it completely correctly and generically is to have a disambiguating pass on an ambiguous parse tree. The alternatives involve generating extra parser states or using PEGs. But PEGs have big issues with error detection and reporting, not to mention correct parsing. There’s just no information on what possible parses are available or what token is expected. Whereas with Earley you can do “Ruby slippers”: scan the sets for what they want next, output “warning: expected ‘;’ at end of statement”, and then add that to the parse forest and continue parsing with almost no overhead.</p>
<p>Treesitter implements incremental LR parsing with error recovery, but since it doesn’t support ambiguity I don’t think it’s sufficient for a compiler.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Overloading.html" class="btn btn-neutral float-right" title="Overloading" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Optimal-Reduction.html" class="btn btn-neutral float-left" title="Optimal reduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019-2020 Mathnerd314

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>