

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Delimited continuations &mdash; Stroscot  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Syntax" href="Syntax.html" />
    <link rel="prev" title="Argument passing" href="Arguments.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Stroscot
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="Arguments.html">Argument passing</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Delimited continuations</a></li>
<li class="toctree-l1"><a class="reference internal" href="Syntax.html">Syntax</a></li>
<li class="toctree-l1"><a class="reference internal" href="Overloading.html">Overloading</a></li>
<li class="toctree-l1"><a class="reference internal" href="Types.html">Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="FAQ.html">FAQ</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Stroscot</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Delimited continuations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/Delimited-Continuations.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="delimited-continuations">
<h1>Delimited continuations<a class="headerlink" href="#delimited-continuations" title="Permalink to this headline">¶</a></h1>
<p>The API for delimited continuations is:</p>
<ul class="simple">
<li><p><strong>newPrompt</strong> — creates a fresh prompt, distinct from all other
prompts. It’s just an object that we use as an identifier, basically.
Some systems simply use symbols for prompts.</p></li>
<li><p><strong>pushPrompt</strong> p e — pushes prompt p on the stack, and executes
expression e in this new context. This <em>delimits</em> the stack, so we
can later capture a delimited continuation up to this part of the
program.</p></li>
<li><p><strong>withSubCont</strong> p f — aborts (unwinds) up to and including the
prompt p, and calls the function f with a single argument k
representing the delimited continuation from the call to withSubCont
up to but not including the prompt. This <em>captures</em> a delimited
continuation, analogous to how call/cc captures an undelimited
continuation. k can then be applied like any other function.</p></li>
</ul>
<p>This is based on “A Framework for Monadic Delimited Continuations” except
that there is no <strong>pushSubCont</strong> because applying a continuation is automatic.</p>
<p>An example is the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">newPrompt</span><span class="p">;</span>
<span class="mi">2</span> <span class="o">+</span> <span class="n">pushPrompt</span> <span class="n">p</span>
      <span class="k">if</span> <span class="n">withSubCont</span> <span class="n">p</span>
           <span class="p">(</span>\<span class="n">k</span><span class="o">.</span> <span class="n">k</span> <span class="kc">False</span> <span class="o">+</span> <span class="n">k</span> <span class="kc">True</span><span class="p">)</span>
        <span class="n">then</span> <span class="mi">3</span> <span class="k">else</span> <span class="mi">4</span>
<span class="c1"># result: 9</span>
</pre></div>
</div>
<p>First we call newPrompt to obtain a fresh prompt and give it a name, p,
for the prompt. Then we have the addition of 2 to a second expression,
that pushPrompt’s p on the stack, i.e. delimits the stack at that point.
The if is called inside the new context delimited by p. The if’s test
expression is a withSubCont p, so it calls the function with k bound to
the rest of the computation between the withSubCont and the pushPrompt,
which, by the magic of delimited control, is equivalent to the function
λb. if b then 3 else 4. We then call it once with False and once with
True as argument, and we add the two results, giving us 7. The result of
the pushPrompt is thus 7, and we return to the addition of 2, giving us
9 as the final result.</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Syntax.html" class="btn btn-neutral float-right" title="Syntax" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Arguments.html" class="btn btn-neutral float-left" title="Argument passing" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019-2020 Mathnerd314

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>